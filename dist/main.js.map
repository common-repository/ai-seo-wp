{"version":3,"file":"main.js","mappings":"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","sources":["webpack://wpseoai-plugin/webpack/startup","webpack://wpseoai-plugin/./src/wpseoai.ts"],"sourcesContent":["// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = {};\n__webpack_modules__[343]();\n","\"use strict\";\n/*\n * WPSEO.AI\n *\n * @package       WPSEOAI\n * @author        WPSEO.AI Ltd\n * License:       MIT\n *\n * NOTE: This may be refactored, at a later date\n */\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n/**\n * Toggle collapsable cards, on the WPSEO.AI dashboard\n */\nconst wpseoaiCardToggles = document.querySelectorAll('.toplevel_page_wpseoai_dashboard .card .toggle');\nif (wpseoaiCardToggles !== null) {\n    wpseoaiCardToggles.forEach((toggle) => {\n        toggle.addEventListener('click', function (e) {\n            var _a, _b;\n            const state = toggle.getAttribute('aria-pressed') === 'true';\n            toggle.setAttribute('aria-pressed', state ? 'false' : 'true');\n            if (state)\n                (_a = toggle.nextElementSibling) === null || _a === void 0 ? void 0 : _a.classList.remove('show');\n            else\n                (_b = toggle.nextElementSibling) === null || _b === void 0 ? void 0 : _b.classList.add('show');\n        });\n    });\n}\n/**\n *\n */\nconst wpseoaiRequest = document.querySelector('#wpseoai-request');\nif (wpseoaiRequest !== null) {\n    const p = document.createElement('p');\n    p.innerText = 'Processing...';\n    wpseoaiRequest.append(p);\n    (() => __awaiter(void 0, void 0, void 0, function* () {\n        var _a, _b, _c;\n        const controller = typeof AbortController === 'undefined' ? undefined : new AbortController();\n        const type = wpseoaiRequest.getAttribute('data-type');\n        // console.log(type);\n        const post = wpseoaiRequest.getAttribute('data-post');\n        // console.log(post);\n        const nonceRequest = wpseoaiRequest.getAttribute('data-nonce-request');\n        // console.log(nonceRetrieve);\n        const nonceAudit = wpseoaiRequest.getAttribute('data-nonce-audit');\n        // console.log(nonceAudit);\n        const url = `${window.location.origin}/wp-json/wpseoai/v1/${type}?post=${post}`;\n        // console.log(url);\n        const tooLongTimeout = setTimeout(() => {\n            const p = document.createElement('p');\n            p.innerHTML = 'This is taking longer than it should. You can <a href=\"\">refresh the page</a>, or try again later. If this problem persists, please <a href=\"https://wpseo.ai/\" target=\"_blank\">contact us</a>';\n            wpseoaiRequest.append(p);\n            controller === null || controller === void 0 ? void 0 : controller.abort();\n        }, 6000);\n        const response = yield fetch(url, {\n            headers: {\n                Accept: \"application/json\",\n                \"Content-Type\": \"application/json\",\n                \"X-WP-Nonce\": nonceRequest\n            },\n            signal: controller === null || controller === void 0 ? void 0 : controller.signal,\n        });\n        const data = yield response.json();\n        // console.log(data);\n        clearTimeout(tooLongTimeout);\n        // console.log(window.location);\n        // console.log(response);\n        const code = (_a = data === null || data === void 0 ? void 0 : data.code) !== null && _a !== void 0 ? _a : response.status;\n        const message = (_b = data === null || data === void 0 ? void 0 : data.message) !== null && _b !== void 0 ? _b : response.statusText;\n        const auditId = (_c = data === null || data === void 0 ? void 0 : data.auditId) !== null && _c !== void 0 ? _c : 0;\n        const dashboardUrl = `${window.location.origin}/wp-admin/admin.php?page=wpseoai_dashboard`;\n        // Error\n        if (response.status > 200\n            || (response.status === 200 && code === 204)) {\n            const p = document.createElement('p');\n            p.innerText = `Error: \"${message}\" (code ${code})`;\n            wpseoaiRequest.append(p);\n            const a = document.createElement('a');\n            a.href = dashboardUrl;\n            a.innerText = `Return to dashboard`;\n            wpseoaiRequest.append(a);\n            // console.error('Request error', response);\n        }\n        // Success\n        else {\n            const p = document.createElement('p');\n            p.innerText = 'Success, redirecting...';\n            wpseoaiRequest.append(p);\n            // console.log('Request success', response);\n            if (auditId) {\n                window.location.href = `${dashboardUrl}&action=audit&post_id=${auditId}&_wpnonce=${nonceAudit}`;\n            }\n            else {\n                window.location.href = dashboardUrl;\n            }\n        }\n    }))();\n}\n"],"names":["__webpack_exports__","__awaiter","this","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","wpseoaiCardToggles","document","querySelectorAll","forEach","toggle","addEventListener","_a","_b","state","getAttribute","setAttribute","nextElementSibling","classList","remove","add","wpseoaiRequest","querySelector","p","createElement","innerText","append","_c","controller","AbortController","undefined","type","post","nonceRequest","nonceAudit","url","window","location","origin","tooLongTimeout","setTimeout","innerHTML","abort","response","fetch","headers","Accept","signal","data","json","clearTimeout","code","status","message","statusText","auditId","dashboardUrl","a","href"],"sourceRoot":""}